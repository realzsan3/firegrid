<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- â–ˆ ç«™ç‚¹ä¿¡æ¯ -->
    <title>FIREGRID - é€€ä¼‘ææ¬¾ Cyber è¿›åº¦æ ¼</title>
    <meta name="description" content="FIREGRID æ˜¯ä¸€æ¬¾èµ›åšæœ‹å…‹é£æ ¼çš„é€€ä¼‘ææ¬¾å¯è§†åŒ–å·¥å…·ã€‚ä¸€æ ¼ä¸€å¹´ï¼ŒåŠ¨æ€å±•ç¤ºèµ„äº§ä¸ææ¬¾è¿›åº¦ï¼ŒåŠ©ä½ è§„åˆ’è´¢åŠ¡è‡ªç”±ã€‚">
    <meta name="keywords" content="FIREGRID, è´¢åŠ¡è‡ªç”±, æå‰é€€ä¼‘, é€€ä¼‘ææ¬¾, FIRE, å¯è§†åŒ–, Cyberpunk">
    <meta name="author" content="FIREGRID Team">

    <!-- â–ˆ Open Graph / Twitter Cardï¼ˆç¤ºä¾‹ï¼ŒæŒ‰éœ€æ›¿æ¢ URLï¼‰ -->
    <meta property="og:title" content="FIREGRID - Cyberpunk Retirement Withdrawal Grid" />
    <meta property="og:description" content="ç”¨èµ›åšæ ¼å­å›¾å¯è§†åŒ–ä½ çš„é€€ä¼‘ææ¬¾ä¸è´¢åŠ¡è‡ªç”±è¿›åº¦ã€‚" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://firegrid.111533.xyz/" />
    <meta property="og:image" content="https://firegrid.111533.xyz/assets/og-image.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="FIREGRID - é€€ä¼‘ææ¬¾å¯è§†åŒ–" />
    <meta name="twitter:description" content="FIREGRIDï¼šä¸€æ ¼ä¸€å¹´ï¼Œç‚¹äº®ä½ çš„è´¢åŠ¡è‡ªç”±ä¹‹è·¯ã€‚" />
    <meta name="twitter:image" content="https://firegrid.111533.xyz/assets/og-image.png" />

    <!-- â–ˆ ç«™ç‚¹å›¾æ ‡ -->
    <meta name="theme-color" content="#0d0f1a" />
    <link rel="icon" type="image/png" href="/assets/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg" />
    <link rel="shortcut icon" href="/assets/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="FIREGRID" />

    <!-- â–ˆ èµ›åšæœ‹å…‹æ ·å¼ -->
    <style>
        :root {
            --bg: #0d0f1a;
            --fg: #39ff14;
            --cols: 10;
        }

        html,
        body {
            margin: 0;
            min-height: 100%;
            background: var(--bg);
            color: var(--fg);
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Consolas, Menlo, monospace;
        }

        header {
            margin-top: 2rem;
            text-align: center
        }

        header img {
            height: 80px;
            margin-bottom: .5rem
        }

        h1 {
            margin: .3rem 0 1rem;
            font-size: 1.8rem;
            letter-spacing: 2px;
            text-shadow: 0 0 8px var(--fg);
        }

        .summary {
            font-size: .9rem;
            color: #9ff;
            margin-bottom: 1.8rem;
            line-height: 1.6;
            text-align: center;
            white-space: pre-line;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(var(--cols), 32px);
            gap: 10px;
            margin-bottom: 2rem;
        }

        .cell {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            border: 1px solid rgba(64, 238, 255, .15);
            box-shadow: 0 0 6px rgba(0, 255, 255, .12);
            opacity: 0;
            transform: scale(.6);
            animation: pop .5s forwards;
            cursor: pointer;
            position: relative;
        }

        @keyframes pop {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Tooltip */
        .cell:hover {
            z-index: 999;
        }

        .cell:hover::after {
            content: attr(data-tip);
            position: absolute;
            left: 36px;
            top: -4px;
            z-index: 1000;
            background: #141622;
            color: #0ff;
            font-size: 12px;
            padding: 8px 10px;
            border: 1px solid #4ff;
            border-radius: 6px;
            box-shadow: 0 0 10px #0ff;
            white-space: pre;
            min-width: 210px;
        }

        footer {
            text-align: center;
            padding: 1.5rem 1rem 2.5rem;
            font-size: .9rem;
            color: #7aa;
        }

        footer a {
            color: #8f5bff;
            text-decoration: none
        }

        footer a:hover {
            text-decoration: underline
        }
    </style>
</head>

<body>
    <!-- â–ˆ LOGO + æ ‡é¢˜ -->
    <header>
        <img src="assets/favicon-96x96.png" alt="FIREGRID logo">
        <h1>FIREGRID</h1>
        <p style="margin:0 0 1.2rem;font-size:.85rem;opacity:.8">Cyberpunk Retirement Withdrawal Grid</p>
    </header>

    <!-- â–ˆ ç”Ÿå‘½å‘¨æœŸæ‘˜è¦åŒº -->
    <div id="summary" class="summary">Loading summaryâ€¦</div>

    <!-- â–ˆ Grid å®¹å™¨ -->
    <div id="grid" class="grid"></div>

    <!-- â–ˆ é¡µè„š -->
    <footer>
        <a href="https://github.com/realzsan/firegrid" target="_blank">GitHub</a><br>
        Â© 2025&nbsp;FIREGRID
    </footer>

    <!-- â–ˆ ä¸»è„šæœ¬ -->
    <script>
        (async () => {
            const res = await fetch('progress.json');
            if (!res.ok) {
                document.getElementById('summary').textContent = 'æ— æ³•åŠ è½½ progress.json';
                return;
            }

            const { summary, records } = await res.json();


            /* ===== æ¸²æŸ“ç”Ÿå‘½å‘¨æœŸæ‘˜è¦ ===== */
            const retired = summary.retired;           // å¸ƒå°”
            const safe = summary.safe;
            const safeTag = safe
                ? (retired ? 'âœ… é€€ä¼‘èµ„é‡‘å®‰å…¨' : 'âœ… èµ„äº§å·²è¾¾æ ‡')
                : (retired ? 'âš ï¸ é€€ä¼‘èµ„é‡‘ä¸è¶³' : 'âš ï¸ èµ„äº§å°šæœªè¾¾æ ‡');

            const retireInfo = retired
                ? `äº <b>${summary.retire_year}</b> å¹´é€€ä¼‘`
                : 'ä»åœ¨ç§¯ç´¯é˜¶æ®µï¼ˆæœªè¾¾é€€ä¼‘ç›®æ ‡ï¼‰';
            const dangerYears = summary.warning_years || [];
            const warningLine = dangerYears.length
                ? `âš ï¸  èµ„äº§è­¦å‘Šå¹´ä»½ï¼š${dangerYears.join(', ')}`
                : '';

            document.getElementById('summary').innerHTML =
                `ğŸ§® ä» <b>${summary.start_year}</b> å¹´å¼€å§‹ï¼Œç»å† <b>${summary.accumulation_years}</b> å¹´ç§¯ç´¯ï¼Œ${retireInfo}ã€‚\n` +
                `æ¨¡æ‹Ÿå…± <b>${records.length}</b> å¹´ï¼Œæœ€ç»ˆå‰©ä½™èµ„äº§ <b>Â¥${summary.final_assets.toLocaleString()}</b>ã€‚\n` +
                `å½“å‰çŠ¶æ€ï¼š<b>${safeTag}</b>` +
                (warningLine ? `\n${warningLine}` : '');


            /* ===== æ¸²æŸ“æ ¼å­ ===== */
            const grid = document.getElementById('grid');
            const COLS = 10;
            document.documentElement.style.setProperty('--cols', COLS);

            const total = records.length;
            records.forEach((d, idx) => {
                const hue = 300 * idx / total;
                const progress = d.progress ?? 0;
                const light = 25 + 30 * progress;
                const color = `hsl(${hue} 100% ${light}%)`;

                const box = document.createElement('div');
                box.className = 'cell';
                box.style.background = color;
                box.style.boxShadow = `0 0 6px ${color}88`;

                // âœ… æ·»åŠ é€€ä¼‘æ ‡è®° ğŸ¯
                if (summary.retired && d.year === summary.retire_year) {
                    box.textContent = 'ğŸ¯';
                    box.style.fontSize = '18px';
                    box.style.textAlign = 'center';
                    box.style.lineHeight = '32px';
                }

                // ========= èµ„äº§âš ï¸è­¦å‘Š =========
                if (d.warning) {                      
                    box.textContent = 'âš ï¸';
                    box.style.fontSize = '18px';
                    box.style.textAlign = 'center';
                    box.style.lineHeight = '32px';
                }
                box.dataset.tip =
                    `YEAR  ${d.year}\nPHASE ${d.phase}\nASSET ${d.assets.toLocaleString()}` +
                    `\næ”¶ç›Šç‡ ${(d.return * 100).toFixed(2)} % \nç°é‡‘æµ ${d.cash_flow} \nPROG  ${(progress * 100).toFixed(1)} `;
                grid.appendChild(box);
            });
        })();
    </script>
</body>

</html>